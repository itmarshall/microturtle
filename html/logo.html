<html>
<head>
    <title>MicroTurtle Logo</title>
	<link rel="stylesheet" type="text/css" href="/style.css"/>
    <script type="text/javascript" src="logo.min.js"></script>

</head>
<body>
	<div class="banner">
		MicroTurtle Logo
	</div>
    <pre id="editor">
; Welcome!
fd 10
rt 90
pu fd 100 pendown
repeat 6 [ fd 1 rt 10 repeat 2 [ fd 2 lt 2 ] ]
make "n 3
repeat :n [ flurgle 3 7 make "n :n - 1 ]
bk 88

; Do something flurgly.
to flurgle :bean :bar
  fd 22
  if ((:bean > 0) And (:bean < 10))
  [
      ; Now repeat flurgles.
      repeat (:bean + 2) * (:bean - 1) + 1 * 2 - 3 / 4 [
        fd 10
        rt 12
      ]
  ]
  else
  [
      BK 10 Lt :bean
  ]
end
    </pre>
    <br>
	<div class="button-bar">
		<a class="button" href="javascript:checkProgram()">Check</a>
		<a class="button" href="javascript:runProgram()">Run</a>
	</div>
    <script src="ace.js" type="text/javascript" charset="utf-8"></script>
	<script src="logo-mode.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/xcode");
        editor.setAutoScrollEditorIntoView(true);
        editor.setOption("minLines", 10);
        editor.setOption("maxLines", 100);
        editor.getSession().setTabSize(4);
        editor.getSession().setUseSoftTabs(false);
        editor.setShowPrintMargin(false);
        editor.setDisplayIndentGuides(false);
		editor.getSession().setMode("ace/mode/logo-mode");

		function handleErrors(exceptions) {
			console.log("Exceptions found:");
			for (var ii = 0; ii < exceptions.length; ii++) {
				var e = exceptions[ii];
				console.log("line " + e.line + ":" + e.col + " " + e.message);
			}
		}

		function checkProgram() {
            // Compile the program to byte code.
            var results = logo.compileProgram();

            if (results.success) {
                // Print out the compiled bytecode.
				alert("Program is valid.");
            } else {
                // Something was wrong, print out the errors.
				handleErrors(results.exceptions);
			}

			return results;
		}

        function runProgram() {
            // Compile the program to byte code.
            var results = logo.compileProgram();

            if (results.success) {
                // Print out the compiled bytecode.
                // TODO: Run it!
            } else {
                // Something was wrong, print out the errors.
				handleErrors(results.exceptions);
            }
        }
    </script>
</body>
</html>
